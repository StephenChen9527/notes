# 9.用正则表达式进行搜索
正则表达式是一个很diao的东西。。但是也比较难学，只会一些基础，在SQL里面也更是没有用过。

## 正则表达式介绍
正则表达式是用来匹配文本的特殊的串（字符集和）。

也需要把正则系统的学习一遍。

## 使用MySQL正则表达式
#### 基本匹配
在MySQL中想使用正则主要是使用`REGEXP`关键字，如:

![正则表达式](https://ws2.sinaimg.cn/large/005VwC5mly1g7daaal27qj30i908775l.jpg)

这里就是匹配包含改字符串的意义。

![正则表达式](https://ws1.sinaimg.cn/large/005VwC5mly1g7dabogh7jj30j208ngmm.jpg)

这里使用了`.`，这个符号在正则表达式中代表匹配任意一个字符（应该是不限制个数的，并不是占1位），当然此方法也可以使用`LIKE`关键字进行实现。

`LIKE`与`REGEXP`两者的区别，在`LIKE`中，他只认识"%"和"_"这两个符号，如果`LIKE`后面的搜索模式并没有写出来任何的通配符，则按照`=`号处理，而`REGEXP`则会按照包含的意思去处理，在`LIKE`中表现为前后都加上了`%`通配符。

`REGEXP`中可以使用`^`和`$`两个符号进行开始与结束的限定。

正则表达式里面不再区分大小写。如果想要区分大小写，则需要`BINARY`关键字，用法：`SELECT * FROM t_user WHERE email REGEXP BINARY '@qq.com$';`

#### 进行OR匹配
![正则表达式中的OR操作](https://wx3.sinaimg.cn/large/005VwC5mly1g7dajw6pgzj30io09i0u0.jpg)

这个实例就代表，正则表达式有两个候选，1000和2000，当然如果需要多个候选，还可以使用`|`进行连接

#### 匹配几个字符串之一

如果想要匹配 特定的字符，则使用`[]`括号。

![正则表达式中的方括号](https://ws4.sinaimg.cn/large/005VwC5mly1g7daooteq7j30ic08rt9p.jpg)

这个`[]`代表中间的任意一个字符与后面的字符进行拼接，那么可检索的有：`1 Ton`、`2 Ton`、`3 Ton`这三个。

事实上，这个其实就是一个缩写，即为：`[1|2|3] Ton` 。

![错误实例](https://wx4.sinaimg.cn/large/005VwC5mly1g7daxawry3j30f207hdga.jpg)

如上图，如果把`[]`去掉，就会发现少检索出很多奇怪的数据，这是因为，MySQL在分析语义的时候，将`1 | 2 |3 Ton`分成了三块`1`、`2`、`3 Ton`，而不是所想的那样，因此要注意这种歧义。

[^123]的意义是匹配除了`1`、`2`、`3`三个字符以外的其他字符。

#### 匹配范围
`[0-9]`是匹配所有数字，`[a-z]`匹配任意字母字符。

#### 匹配特殊字符
如果想要匹配特殊字符，就需要使用`\\`进行转义。如：`\\.`匹配点，如果不加，则匹配任意的。`\\-`匹配`-`。

空白元字符：
| 元字符 |   说明   |
|:------:|:--------:|
|  \\f   |   换页   |
|  \\n   |   换行   |
|  \\r   |   回车   |
|  \\t   |   制表   |
|  \\v   | 纵向制表 |

为了匹配`\`，则要使用`\\\`三个。

#### 匹配字符类
字符表：

|      类      |                      说明                      |
|:------------:|:----------------------------------------------:|
| `[:alnum:]`  |        任意字母和数字（`[a-zA-Z0-9]`）         |
| `[:alpha:]`  |             任意字符（`[a-zA-Z]`）             |
| `[:blank:]`  |             空格和制表（`[\\t]`）              |
| `[:cntrl:]`  |        ASCII控制字符(`ASCII 0-31和127`)        |
| `[:digit:]`  |              任意数字（`[0-9]`）               |
| `[:graph:]`  |        与`[:print:]`相同，但不包含空格         |
| `[:lower:]`  |            任意小写字母（`[a-z]`）             |
| `[:print:]`  |                 任意可打印字符                 |
| `[:punct:]`  | 既不在`[:alnum:]`又不在`[:cntrl:]`中的任意字符 |
| `[:space:]`  |            任意大写字母（`[A-Z]`）             |
| `[:xdigit:]` |       任意十六进制数字（`[a-fA-F0-9]`）        |

#### 匹配多个实例
上面的几个都是只能匹配单次出现。如果存在一个匹配，该行被检索出来，如果不存在，检索不出任何行。

匹配重复元字符：

| 元字符  |             说明             |
|:-------:|:----------------------------:|
|   `*`   |        0个或多个匹配         |
|   `+`   |        1个或多个匹配         |
|   `?`   |         0个或1个匹配         |
|  `{n}`  |        指定数目的匹配        |
| `{n,}`  |     不少于指定书目的匹配     |
| `{n,m}` | 匹配数目的范围（m不超过255） |


#### 定位符

|  元字符   |    说明    |
|:---------:|:----------:|
|    `^`    | 文本的开始 |
|    `$`    | 文本的结尾 |
| `[[:<:]]` |  词的开始  |
| `[[:>:]]` |  词的结尾  |

![正则表达式](https://wx1.sinaimg.cn/large/005VwC5mly1g7dug95rfaj30yn0h2adf.jpg)

`^`的双重用途，在集合中(用[和]定义)。用来否定该合集，否则，用来指串的开始处。

使用`REGEXP`起类似LIKE的作用 `LIKE`匹配整个串，而`REGEXP`用来匹配子串，利用定位符号，通过用`^`开始每个表达式，`$`结束每个表达式，可以使`REGEXP`的作用与`LIKE`一样。

简单的正则表达式测试，在不使用数据库表的情况下，测试表达式，用法：`SELECT 'xxx' REGEXT 'regexp';`

如果能匹配，就返回1，否则返回0。

## 总结
本章主要是介绍了MySQL中的正则表达式，跟大部分语言中的正则很相似，用处暂时不大，因此可以先大体了解，然后好好学习正则表达式后，再来查看本章节内容。

正则还是牛逼....

# 18.全文搜索
## 理解全文搜索

`MyISAM`支持全文搜索，`InnoDB`不支持。

`LIKE`和正则表达式都可以进行搜索匹配，但是存在几个重要的限制：
* 性能--通配符和正则表达式匹配通常要求MySQL尝试匹配表中所有行（且这些搜索极少使用表索引）。因此，由于被搜索的行数不断增加，这些搜索可能非常耗时。
* 明确控制--使用通配符和正则表达式匹配，很难（而且并不总是能）很明确地匹配什么和不匹配什么。
* 智能化的结果--虽然基于通配符和正则表达式的搜索提供了非常灵活的搜索，但是它们都不能提供一种智能化的选择结果的方法。

## 使用全文本搜索
为了进行全文搜索，必须索引被搜索的列。在索引之后，`SELECT`可与`Match()`和`Against()`一起使用以实际执行搜索。

启用全文文本搜索的支持即在创建表的时候，使用`FULLTEXT`：

![FULLTEXT的用法](https://tva4.sinaimg.cn/large/005VwC5mly1g7saj4n44aj30gn077q3r.jpg)

使用这个字段的时候，MySQL自动维护该索引，在增加、更新或删除行时，索引会随之自动更新。

![注意事项](https://tvax1.sinaimg.cn/large/005VwC5mly1g7sapgk1p9j30mo0770vc.jpg)

使用`Match()`和`Against()`进行搜索，其中`Match()`指定被搜索的列，`Against()`指定要使用的搜索表达式。

如`SELECT note_text FROM productnotes WHERE Match(note_text) Against('rabbit');`

`Match`方法中的列必须与`FULLTEXT`中的一致，如果要指定多个列，则必须列出它们，而且次序正确，且默认情况下全文本搜索不区分大小写。

用`LIKE`也能检索出同样的数据，但是顺序并不一定相同，因为在全文本搜索下，会返回该字符串在原串中的位置。且子串靠前，排序也靠前。

具体工作原理可以看书上的例子，`Against()`函数返回的等级值，子串位置靠前，则等级值大。

>排序多个搜索项 如果指定多个搜索项，则包含多数匹配词的那些行将具有比包含较少词（或仅有一个匹配）的那些行高的等级值。

全文搜索比`LIKE`快，是因为MySQL自动维护了一个索引。

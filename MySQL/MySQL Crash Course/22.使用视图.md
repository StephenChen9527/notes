## 使用视图
`MySQL`是在5以后增加了视图。
## 视图

视图是虚拟的表，与包含数据的表不一样，视图只包含使用时动态检索数据的查询。

为什么使用视图：
1. 重用SQL语句。
2. 简化复杂的SQL操作，在编写查询之后，可以方便地重用而不必知道它的基本查询细节。
3. 使用表的组成部分而不是整个表。
4. 保护数据，可以给用户授予表的特定部分的访问权限而不是整个表的访问权限
5. 更改数据格式和表示，视图可以返回与底层表的表示和格式不同的数据。

性能问题。由于每次都必须处理查询执行时所需的任一个检索，如果使用和过滤创建了复杂的视图，或者嵌套了视图，可能会发现，性能下降的很厉害。

视图的限制：
1. 与表一样，视图必须有唯一的命名（且不与表相同）。
2. 对于可以创建的视图数目没有限制。
3. 为了创建视图，必须y具有足够的权限。
4. 视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图。
5. `ORDER BY`可以用在视同，但如果从改视图检索数据`SELECT`中也含有`ORDER BY`，那么视图中的`ORDER BY`被覆盖。（以最后的筛选数据排序为准）
6. 视图不能索引，也不能关联触发器或有默认值。
7. 视图可以和表一起使用。

## 使用视图
* 使用`CREATE VIEW`来创建视图。
* 使用`SHOW CREATE VIEW viewname;`用来查看创建视图的语句。
* 使用`DROP VIEW viewname;`来删除视图
* 更新视图，可以先使用`DROP`再`CREATE`，也可以直接使用`CREATE OR REPLACE VIEW;`。

![创建视图](https://tvax2.sinaimg.cn/large/005VwC5mly1g7yq894hj5j30s208ztbt.jpg)

当在使用`SELECT cust_name,cust_contact FROM productcustomers WHERE prod_id = 'TNT2';`这个语句主要是从视图中检索数据。

感觉视图有点类似于子查询？ 在子查询的结果集上再进行检索？

使用视图也可以使用`WHERE`子句。当视图中使用`WHERE`子句，且`SELECT`中也使用子句，则自动结合。

视图也可以使用计算字段a+b、a*b等

更新视图将更新其基表，比如对视图增加或删除行，实际上是对其基表增加或删除行。

并非所有的视图都是可以更新的，基本上说，如果MySQL不能者却的确定被更新数据，则不允许更新（插入、删除），实际上意味着，如果视图中定义的有以下操作，则不能进行视图更新：
* 分组（`GROUP BY`和`HAVING`）
* 联结
* 子查询
* 并
* 聚集函数
* DISTINCT
* 导出（计算）列

这些都是在MySQL5的时候的限制，不知道5.7如何。

而且一般情况下，视图应该用于检索（`SELECT`语句），而不用于更新（`INSERT`、`UPDATE`和`DELETE`）

## 总结
视图为续表，不存在的表，但是更新虚表却直接映射到了实表中去。视图是提供了一种对`SELECT`语句的封装，将复杂的语句提取出来，既可以重用，也方便维护。

视图总感觉像是进行了一次筛选，然后再从这个视图的返回集中进行查询、过滤，有点嵌套子查询的味道。

貌似视图跟临时表又不太一样....晕...

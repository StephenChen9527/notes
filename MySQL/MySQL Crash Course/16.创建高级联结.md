# 16.创建高级联结

## 使用别名
别名除了用于列明和计算字段之外，还允许给表名起别名，这样做主要有两个理由：
* 缩短SQL语句
* 允许在单条`SELECT`语句中多次使用相同的表

## 使用不同类型的联结
联结种类：
1. 内部联结（等值联结）：适用于两个表或者是多个表有关系的情况（`INNER JOIN`或`=`相连接）
2. 自联结：一个表自己和自己连接。
3. 自然联结：是一种特殊的等值连接，它要求两个关系中进行比较的分量必须是相同的属性组，并且在结果中把重复的属性列去掉，系统并不会完成他， 而是自己在`SELECT`语句后进行筛选属性，去掉重复的。
4. 外部联结：包含左外联结（`LEFT OUT JOIN`=`LEFT JOIN`）跟右外联结（`RIGHT OUT JOIN`=`RIGHT JOIN`），左连接为左边左右的行去匹配右表的，如果无法匹配，则为NULL，右联结相反。


`https://www.cnblogs.com/yyjie/p/7788413.html`，四种联结的解释。

自联结通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句，但是有时候处理联远比处理子查询快的多，应该试一下两种方法，看哪个更好。

## 使用带聚集函数的联结

可以在两表联结中使用聚集函数，其与使用聚集函数需要注意的类似。

1. 当聚集函数和非聚集函数出现在一起时，需要将非聚集函数进行group by
2. 当只做聚集函数查询时候，就不需要进行分组了。

`https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html#sqlmode_only_full_group_by`

`https://stackoverflow.com/questions/38907729/mysql-5-7-only-full-group-by`

在自己看着书中的例子，并且重新写了一遍，`GROUP BY`的条件换为了`cust_name`就会报错，根据网上查询，貌似是因为5.7以后MySQL有了限制。

我的理解：是因为`cust_name`并不是唯一的？当我在`cust_name`中添加了唯一性约束的时候，发现`GROUP BY`名字这个列是可以的，那么，这是由于`GROUP BY`之前，MySQL会进行某种约束查询，如果这个列非唯一，可能会有多个，因为`cust_name`可能存在多个， 那么返回的`cust_id`就是多个了，但是`GROUP BY`的`cust_name`却分组成1个，这就一定程度上是有问题的，因此在这里需要稍微注意一下。`GROUP BY`一定要是有区分的列。

### 与HTTP协作的Web服务器
##### 用单台虚拟主机实现多个域名
`HTTP/1.1`规范允许一台HTTP服务器搭建多个Web站点，即使物理层只有一台服务器，但只要使用虚拟主机的功能，则可以假设已具有多台服务器。

域名通过DNS服务映射到IP地址之后，访问目标网站，课件，当请求发送到服务器的时候，已经是以IP地址的形式访问了。

如果一台服务器托管了两个域名，当收到请求时就需要弄清楚酒精是要访问哪个域名，因此在发送HTTP请求时，必须在`Host`首部内完整指定主机名或者域名的URI。

也就是说，其实通过域名发送`HTTP`请求的时候，会自动的添加了`Host`的值？

曾经有次通过`IP`直接请求，报错，指定了`Header`中的`Host`就正常。不知道是跟这个有关系不。

##### 5.2通信数据转发程序：代理、网关、隧道
代理：

代理是一种有转发功能的应用程序，接受客户端发送的请求，并转发给服务器，同时也接受服务器返回的响应并转发给客户端，代理不会改变请求URI。

![程序经过代理服务器](https://ws3.sinaimg.cn/large/005VwC5mly1g6wq08qwz7j30xk0b1k5n.jpg)

每次通过代理服务器转发请求或者响应的时候，会追加写入Via首部信息。

使用代理服务器的理由：利用缓存技术，访问控制，获取日志等。

* 缓存代理：带有缓存的代理服务器。
* 透明代理：不对请求和响应做任何加工的代理。

网关：

网关是转发其他服务器通信数据的服务器，接受从客户端发送来的请求时，它就像自己拥有资源的服务器一样对请求进行处理。

ps：总觉得网关更像一个入口，也做转发的程序....

![网关](https://ws4.sinaimg.cn/large/005VwC5mly1g6wq49hsayj30vn09wjxq.jpg)

从上图看，总觉得网关程序更像是一个适配器，转换各种协议。

隧道：

隧道是相隔甚远的客户端和服务器之间的中转，并保持双方通信的连接的应用程序（基站？？？运营商？？？）。

![隧道](https://ws3.sinaimg.cn/large/005VwC5mly1g6wq7vqyiej30ze07r0yq.jpg)

隧道可按照要求建立起与其他服务器的通信线路，届时使用SSL等加密手段进行通信。隧道的目标就是确保客户端能与服务器进行安全通信。

HTTPS协议其实就是使用了隧道？？？

##### 5.3保存资源的缓存
缓存是指代理服务器或客户端本地磁盘内保留的资源副本，利用缓存可减少对资源服务器的访问，节省通信流量和通信时间。

![缓存服务器](https://wx2.sinaimg.cn/large/005VwC5mly1g6wqb49dmxj30tm0n5tmv.jpg)

上面可以看出，当缓存服务器保存资源后，后续请求到缓存服务器后，就不再访问真正的资源服务器了，减少了服务器压力。

缓存的存在可能导致客户端请求到的资源并非最新的，而是老的资源的缓存，因此涉及到缓存的有效期。

客户端的缓存保存在本地磁盘中，同样会存在过期的情况，都是有有效期的，而客户端本地的缓存，可以自己强制删除，然后再去请求服务器获取资源。

HTTP协议之前的其他协议：
* `FTP（File Transfer Protocol）` 比TCP/IP还早，主要用于文件传输，现在还有FTP服务器的存在。
* `NNTP（Network News Transfer Protocol）`
* `Archie`
* `WAIS（Wide Area Information Servers）` 关键词检索多个数据库使用的协议
* `Gopher`：查找与互联网连接的计算机内信息的协议。

### HTTP报文内的HTTP信息
##### 3.1HTTP报文
请求端的HTTP报文叫做请求报文，响应端的报文叫做响应报文。

`HTTP报文`本身是由报文首部和报文主体两块，两者由最初出现的空行（CR+LF）来划分。ps：并不一定要有报文主体。
* `CR`：回车符：16进制 0X0d
* `LF`：换行符：16进制 0X0a

![报文组成](https://wx2.sinaimg.cn/large/005VwC5mly1g6ughhrtjkj30s908gjvf.jpg)

##### 3.2请求报文及响应报文的结构
请求报文组成：
* 请求行：包含用于请求的方法，请求URI和HTTP版本。
* 状态行：包含标明响应结果的状态码，原因短语和HTTP版本。
* 首部字段：包含表示请求和响应的各种条件和属性的各类首部。一般包含4中：通用首部、请求首部、响应首部和实体首部。

还可能包含HTTP的RFC里未定义的首部（Cookie等）。

##### 3.3编码提升传输速率
HTTP在传输数据时可以按照数据原貌直接传输，但也可以在传输过程中通过编码提升传输速率。

###### 报文主体和实体的差异
* 报文（message）

HTTP通信中的基本单位，8位字节流组成。

* 实体（entity）

作为请求活响应的有效载荷数据（补充项），由实体首部和实体主体组成（参数？）。

###### 压缩传输
常用压缩：
* gzip（GNU zip，常用，在google的F12里面经常看到是gzip）
* compress（UNIX系统中的标准压缩）
* defalte（zlib）
* identity（不进行编码）

###### 分割发送的分块传输编码
在传输大容量数据时，通过把数分割成多块，能够让浏览器逐步显示页面。

这种把实体主体分块的功能称为分块（数据包？）传输编码。

分块传输编码会将实体主体分成多个部分（数据包？），每一块都会用十六进制来标记块的大小，实体主体的最后一块会用“0（CR+LF）”来标记。

HTTP/1.1 中存在`传输编码`的机制，可以用在通信时按照某种编码方式传输，但之定义作用于分块传输编码中。

##### 3.4发送多种数据的多部分对象集合
MIME（Multipurpose Internet Mail Extensions，多用途因特网邮件扩展），它允许邮件处理文本、图片、视频等多个不同类型的数据，在MIME扩展中会使用一种称为多部分对象（Multipart）的方法，来容纳多份不同类型的数据。

HTTP协议中也采用了多部分对象集合，发送的一份报文主体内可以包含多类型实体。

* `multipart/form-data`：在web表单中上传文件使用
* `multipart/byteranges`：状态码206，响应报文内包含了多个范围的内容（多种文件类型？）时使用。

在 HTTP报文中使用多部分对象集合时，需要再首部字段里加上`Content-type`。

ps：这个好像并不常见。

##### 3.5获取部分内容的范围请求

范围发送的请求叫做范围请求（在较大文件的时候，可以分段请求数据。所谓的断点续传？？）。

![分段请求](https://wx3.sinaimg.cn/large/005VwC5mly1g6ukrordgwj30re0l3nak.jpg)

请求的时候请求头带有参数 Range，返回报文头中有Content-Range，在百度文库请求中，返回的报文头中确实有找个，但是请求头中没找到相关参数。

byte范围形式如下：

|             示例             |                     释义                      |
|:----------------------------:|:---------------------------------------------:|
|   Range: bytes=5001-10000    |              5001-10000字节数据               |
|      Range: bytes=5001-      |              5001字节之后的全部               |
| Range: bytes=-300, 5000-7000 | 从一开始到3000字节，和5000-7000字节的多重范围 |

针对范围请求，返回为`206 Parital Content`的响应报文，对于多重范围请求，响应会在首部字段`Content-Type`标明`multipart/byteranges`后返回响应报文。

如果服务器无法响应返回请求，则会返回状态码`200 OK`和完整的实体内容。

##### 3.6内容协商返回最合适的内容
内容写上机制是指客户端和服务器端就响应的资源内容进行交涉，然后提供给客户端最为合适的资源。

* Accpet
* Accept-Charset
* Accept-Encoding
* Accept-Language
* Content-Language

内容协商技术有以下三种类型：
1. 服务器驱动协商
2. 客户端驱动协商
3. 透明协商

这章节主要讲了HTTP报文中的一些东西，了解到了请求报文中可以分段请求byte数据，返回分段数据。

了解到了HTTP报文的基本构成与传输多种对象的协议。
